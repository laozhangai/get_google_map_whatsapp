<!DOCTYPE html>
<html lang="cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>基于谷歌地图免费采集WhatsApp电话号码</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .custom-select {
            height: 150px;
            overflow-y: auto;
        }
        .disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center h-screen">
    <div class="bg-white p-8 rounded shadow-md w-full max-w-md">
        <h1 class="text-2xl font-bold mb-6">基于谷歌地图免费采集WhatsApp电话号码</h1>
        <form id="queryForm" class="space-y-4">
            <div>
                <label for="keywords" class="block text-sm font-medium text-gray-700">关键词(一次只输入一个关键词)</label>
                <input type="text" id="keywords" name="keywords" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
            </div>
            <div>
                <label for="regions" class="block text-sm font-medium text-gray-700">选择区域</label>
                <div class="space-y-2">
                    <div>
                        <input type="checkbox" id="select_all_europe" class="mr-2">
                        <label for="select_all_europe">全选欧洲</label>
                    </div>
                    <div>
                        <input type="checkbox" id="select_all_asia" class="mr-2">
                        <label for="select_all_asia">全选亚洲</label>
                    </div>
                    <div>
                        <input type="checkbox" id="select_all_americas" class="mr-2">
                        <label for="select_all_americas">全选美洲</label>
                    </div>
                    <div>
                        <input type="checkbox" id="select_all_africa" class="mr-2">
                        <label for="select_all_africa">全选非洲</label>
                    </div>
                    <div>
                        <input type="checkbox" id="select_all_oceania" class="mr-2">
                        <label for="select_all_oceania">全选大洋洲</label>
                    </div>
                </div>
            </div>
            <div>
                <label for="countries" class="block text-sm font-medium text-gray-700">选择目标国家</label>
                <select id="countries" name="countries" multiple class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm custom-select">
                    <optgroup label="欧洲">
                        <option value="al">阿尔巴尼亚</option>
                        <option value="ad">安道尔</option>
                        <option value="am">亚美尼亚</option>
                        <option value="at">奥地利</option>
                        <option value="az">阿塞拜疆</option>
                        <option value="by">白俄罗斯</option>
                        <option value="be">比利时</option>
                        <option value="ba">波斯尼亚和黑塞哥维那</option>
                        <option value="bg">保加利亚</option>
                        <option value="hr">克罗地亚</option>
                        <option value="cy">塞浦路斯</option>
                        <option value="cz">捷克</option>
                        <option value="dk">丹麦</option>
                        <option value="ee">爱沙尼亚</option>
                        <option value="fi">芬兰</option>
                        <option value="fr">法国</option>
                        <option value="ge">格鲁吉亚</option>
                        <option value="de">德国</option>
                        <option value="gr">希腊</option>
                        <option value="hu">匈牙利</option>
                        <option value="is">冰岛</option>
                        <option value="ie">爱尔兰</option>
                        <option value="it">意大利</option>
                        <option value="kz">哈萨克斯坦</option>
                        <option value="lv">拉脱维亚</option>
                        <option value="li">列支敦士登</option>
                        <option value="lt">立陶宛</option>
                        <option value="lu">卢森堡</option>
                        <option value="mt">马耳他</option>
                        <option value="md">摩尔多瓦</option>
                        <option value="mc">摩纳哥</option>
                        <option value="me">黑山</option>
                        <option value="nl">荷兰</option>
                        <option value="mk">北马其顿</option>
                        <option value="no">挪威</option>
                        <option value="pl">波兰</option>
                        <option value="pt">葡萄牙</option>
                        <option value="ro">罗马尼亚</option>
                        <option value="ru">俄罗斯</option>
                        <option value="sm">圣马力诺</option>
                        <option value="rs">塞尔维亚</option>
                        <option value="sk">斯洛伐克</option>
                        <option value="si">斯洛文尼亚</option>
                        <option value="es">西班牙</option>
                        <option value="se">瑞典</option>
                        <option value="ch">瑞士</option>
                        <option value="tr">土耳其</option>
                        <option value="ua">乌克兰</option>
                        <option value="uk">英国</option>
                        <option value="va">梵蒂冈</option>
                    </optgroup>
                    <optgroup label="亚洲">
                        <option value="cn">中国</option>
                        <option value="jp">日本</option>
                        <option value="kr">韩国</option>
                        <option value="in">印度</option>
                        <option value="sg">新加坡</option>
                        <option value="af">阿富汗</option>
                        <option value="bd">孟加拉国</option>
                        <option value="bt">不丹</option>
                        <option value="bn">文莱</option>
                        <option value="kh">柬埔寨</option>
                        <option value="id">印度尼西亚</option>
                        <option value="ir">伊朗</option>
                        <option value="iq">伊拉克</option>
                        <option value="il">以色列</option>
                        <option value="jo">约旦</option>
                        <option value="kw">科威特</option>
                        <option value="kg">吉尔吉斯斯坦</option>
                        <option value="la">老挝</option>
                        <option value="lb">黎巴嫩</option>
                        <option value="my">马来西亚</option>
                        <option value="mv">马尔代夫</option>
                        <option value="mn">蒙古</option>
                        <option value="mm">缅甸</option>
                        <option value="np">尼泊尔</option>
                        <option value="om">阿曼</option>
                        <option value="pk">巴基斯坦</option>
                        <option value="ph">菲律宾</option>
                        <option value="qa">卡塔尔</option>
                        <option value="sa">沙特阿拉伯</option>
                        <option value="lk">斯里兰卡</option>
                        <option value="sy">叙利亚</option>
                        <option value="tw">台湾</option>
                        <option value="tj">塔吉克斯坦</option>
                        <option value="th">泰国</option>
                        <option value="tm">土库曼斯坦</option>
                        <option value="ae">阿联酋</option>
                        <option value="uz">乌兹别克斯坦</option>
                        <option value="vn">越南</option>
                        <option value="ye">也门</option>
                    </optgroup>
                    <optgroup label="美洲">
                        <option value="ar">阿根廷</option>
                        <option value="bs">巴哈马</option>
                        <option value="bb">巴巴多斯</option>
                        <option value="bz">伯利兹</option>
                        <option value="bo">玻利维亚</option>
                        <option value="br">巴西</option>
                        <option value="ca">加拿大</option>
                        <option value="cl">智利</option>
                        <option value="co">哥伦比亚</option>
                        <option value="cr">哥斯达黎加</option>
                        <option value="cu">古巴</option>
                        <option value="dm">多米尼加</option>
                        <option value="do">多米尼加共和国</option>
                        <option value="ec">厄瓜多尔</option>
                        <option value="sv">萨尔瓦多</option>
                        <option value="gd">格林纳达</option>
                        <option value="gt">危地马拉</option>
                        <option value="gy">圭亚那</option>
                        <option value="ht">海地</option>
                        <option value="hn">洪都拉斯</option>
                        <option value="jm">牙买加</option>
                        <option value="mx">墨西哥</option>
                        <option value="ni">尼加拉瓜</option>
                        <option value="pa">巴拿马</option>
                        <option value="py">巴拉圭</option>
                        <option value="pe">秘鲁</option>
                        <option value="kn">圣基茨和尼维斯</option>
                        <option value="lc">圣卢西亚</option>
                        <option value="vc">圣文森特和格林纳丁斯</option>
                        <option value="sr">苏里南</option>
                        <option value="tt">特立尼达和多巴哥</option>
                        <option value="us">美国</option>
                        <option value="uy">乌拉圭</option>
                        <option value="ve">委内瑞拉</option>
                    </optgroup>
                    <optgroup label="非洲">
                        <option value="dz">阿尔及利亚</option>
                        <option value="ao">安哥拉</option>
                        <option value="bj">贝宁</option>
                        <option value="bw">博茨瓦纳</option>
                        <option value="bf">布基纳法索</option>
                        <option value="bi">布隆迪</option>
                        <option value="cm">喀麦隆</option>
                        <option value="cv">佛得角</option>
                        <option value="cf">中非共和国</option>
                        <option value="td">乍得</option>
                        <option value="km">科摩罗</option>
                        <option value="cd">刚果（金）</option>
                        <option value="cg">刚果（布）</option>
                        <option value="ci">科特迪瓦</option>
                        <option value="dj">吉布提</option>
                        <option value="eg">埃及</option>
                        <option value="gq">赤道几内亚</option>
                        <option value="er">厄立特里亚</option>
                        <option value="sz">斯威士兰</option>
                        <option value="et">埃塞俄比亚</option>
                        <option value="ga">加蓬</option>
                        <option value="gm">冈比亚</option>
                        <option value="gh">加纳</option>
                        <option value="gn">几内亚</option>
                        <option value="gw">几内亚比绍</option>
                        <option value="ke">肯尼亚</option>
                        <option value="ls">莱索托</option>
                        <option value="lr">利比里亚</option>
                        <option value="ly">利比亚</option>
                        <option value="mg">马达加斯加</option>
                        <option value="mw">马拉维</option>
                        <option value="ml">马里</option>
                        <option value="mr">毛里塔尼亚</option>
                        <option value="mu">毛里求斯</option>
                        <option value="ma">摩洛哥</option>
                        <option value="mz">莫桑比克</option>
                        <option value="na">纳米比亚</option>
                        <option value="ne">尼日尔</option>
                        <option value="ng">尼日利亚</option>
                        <option value="rw">卢旺达</option>
                        <option value="st">圣多美和普林西比</option>
                        <option value="sn">塞内加尔</option>
                        <option value="sc">塞舌尔</option>
                        <option value="sl">塞拉利昂</option>
                        <option value="so">索马里</option>
                        <option value="za">南非</option>
                        <option value="ss">南苏丹</option>
                        <option value="sd">苏丹</option>
                        <option value="tz">坦桑尼亚</option>
                        <option value="tg">多哥</option>
                        <option value="tn">突尼斯</option>
                        <option value="ug">乌干达</option>
                        <option value="zm">赞比亚</option>
                        <option value="zw">津巴布韦</option>
                    </optgroup>
                    <optgroup label="大洋洲">
                        <option value="au">澳大利亚</option>
                        <option value="fj">斐济</option>
                        <option value="ki">基里巴斯</option>
                        <option value="mh">马绍尔群岛</option>
                        <option value="fm">密克罗尼西亚</option>
                        <option value="nr">瑙鲁</option>
                        <option value="nz">新西兰</option>
                        <option value="pw">帕劳</option>
                        <option value="pg">巴布亚新几内亚</option>
                        <option value="ws">萨摩亚</option>
                        <option value="sb">所罗门群岛</option>
                        <option value="to">汤加</option>
                        <option value="tv">图瓦卢</option>
                        <option value="vu">瓦努阿图</option>
                    </optgroup>
                </select>
            </div>
            
            <script>
                document.getElementById('select_all_europe').addEventListener('change', function() {
                    const europeOptions = document.querySelectorAll('optgroup[label="欧洲"] option');
                    europeOptions.forEach(option => option.selected = this.checked);
                });
            
                document.getElementById('select_all_asia').addEventListener('change', function() {
                    const asiaOptions = document.querySelectorAll('optgroup[label="亚洲"] option');
                    asiaOptions.forEach(option => option.selected = this.checked);
                });
            
                document.getElementById('select_all_americas').addEventListener('change', function() {
                    const americasOptions = document.querySelectorAll('optgroup[label="美洲"] option');
                    americasOptions.forEach(option => option.selected = this.checked);
                });
            
                document.getElementById('select_all_africa').addEventListener('change', function() {
                    const africaOptions = document.querySelectorAll('optgroup[label="非洲"] option');
                    africaOptions.forEach(option => option.selected = this.checked);
                });
            
                document.getElementById('select_all_oceania').addEventListener('change', function() {
                    const oceaniaOptions = document.querySelectorAll('optgroup[label="大洋洲"] option');
                    oceaniaOptions.forEach(option => option.selected = this.checked);
                });
            </script>

            <div>
                <label for="email" class="block text-sm font-medium text-gray-700">用于接收查询结果的电子邮件</label>
                <input type="email" id="email" name="email" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
            </div>
            <div>
                <button type="submit" id="submitButton" class="w-full bg-indigo-600 text-white px-3 py-2 rounded-md shadow-sm hover:bg-indigo-700">免费采集(50条记录)</button>
            </div>
        </form>
        <div id="message" class="mt-4 text-center text-green-600"></div>
        <div class="mt-4 text-center">
            <a href="/jewelry_20240808031612.xlsx" target="_blank" class="text-indigo-600 hover:underline">下载示例数据</a>
        </div>
        <div class="mt-2 text-center">
            <span>微信 jewelryzhang</span>
        </div>
    </div>

    <script>
        document.getElementById('queryForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const submitButton = document.getElementById('submitButton');
            submitButton.disabled = true;
            submitButton.classList.add('disabled');

            const keywords = document.getElementById('keywords').value;
            const countries = Array.from(document.getElementById('countries').selectedOptions).map(option => option.value);
            const email = document.getElementById('email').value;

            fetch('/query', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ keywords, countries, email })
            })
            .then(response => response.json())
            .then(data => {
                submitButton.disabled = false;
                submitButton.classList.remove('disabled');
                if (data.success) {
                    document.getElementById('message').innerText = '提交成功，请稍后查收邮箱。';
                } else {
                    document.getElementById('message').innerText = '提交失败，请重试。';
                }
            })
            .catch(error => {
                submitButton.disabled = false;
                submitButton.classList.remove('disabled');
                document.getElementById('message').innerText = '提交失败，请重试。';
            });
        });

        document.getElementById('select_all_europe').addEventListener('change', function() {
            const europeOptions = document.querySelectorAll('optgroup[label="欧洲"] option');
            europeOptions.forEach(option => option.selected = this.checked);
        });

        document.getElementById('select_all_asia').addEventListener('change', function() {
            const asiaOptions = document.querySelectorAll('optgroup[label="亚洲"] option');
            asiaOptions.forEach(option => option.selected = this.checked);
        });
    </script>
</body>
</html>
